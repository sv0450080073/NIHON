#pragma checksum "E:\Project\HassyaAllrightCloud\Pages\Components\EditYatoiShaBooking.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "c0803bc91d7a38f6537d1af6f780c6ae7cfe9790"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace HassyaAllrightCloud.Pages.Components
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Globalization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Infrastructure.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Dto;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Helpers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Constants;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Extensions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using BlazorContextMenu;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Application.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.Extensions.Localization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 26 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.IService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot;

#line default
#line hidden
#nullable disable
#nullable restore
#line 30 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor.Reporting;

#line default
#line hidden
#nullable disable
#nullable restore
#line 31 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 32 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 33 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 35 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen;

#line default
#line hidden
#nullable disable
#nullable restore
#line 38 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components.CommonComponents;

#line default
#line hidden
#nullable disable
    public partial class EditYatoiShaBooking : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 306 "E:\Project\HassyaAllrightCloud\Pages\Components\EditYatoiShaBooking.razor"
       
    [Parameter] public IncidentalViewMode CurrentViewMode { get; set; }
    [Parameter] public LoadYFutTu LoadYFutTuOrigin { get; set; }
    [Parameter] public bool IsEditMode { get; set; }

    [Parameter] public List<ScheduleSelectorModel> FutaiScheduleList { get; set; }
    [Parameter] public List<LoadYFutai> LoadYFutaiList { get; set; }
    [Parameter] public List<LoadYTsumi> LoadYTsumiList { get; set; }
    [Parameter] public List<LoadYRyokin> LoadYRyokinList { get; set; }
    [Parameter] public List<LoadYSeisan> LoadYSeisanList { get; set; }
    [Parameter] public List<YouShaSaveType> SaveTypeList { get; set; }
    [Parameter] public List<TaxTypeList> TaxTypeDataList { get; set; }
    [Parameter] public List<SettingQuantity> SettingQuantityList { get; set; }
    [Parameter] public SettingTaxRate SettingTaxRate { get; set; }

    [Parameter] public EventCallback<int> OnSubmit { get; set; }
    [Parameter] public EventCallback<int> OnCancel { get; set; }

    protected EditContext FormContext { get; set; }
    protected LoadYFutTu LoadYFutTuModel { get; set; }
    protected bool ShowSettingQuantity { get; set; }
    protected string TempStr { get; set; }
    protected Dictionary<string, string> LangDic { get; set; }

    protected override void OnInitialized()
    {
        LangDic = Lang.GetAllStrings().ToDictionary(l => l.Name, l => l.Value);
        if (IsEditMode)
        {
            LoadYFutTuOrigin.FirstLoad = true;
            var json = JsonConvert.SerializeObject(LoadYFutTuOrigin);
            LoadYFutTuModel = JsonConvert.DeserializeObject<LoadYFutTu>(json);
            LoadSelectedDataCombobox(LoadYFutTuModel);
            LoadYFutTuModel.FirstLoad = false;
        }
        else
        {
            LoadYFutTuModel = LoadYFutTuOrigin;
        }
        FormContext = new EditContext(LoadYFutTuModel);
    }

    protected override void OnAfterRender(bool firstRender)
    {
        JSRuntime.InvokeVoidAsync("setEventforCurrencyField");
        JSRuntime.InvokeAsync<string>("loadPageScript", "bookingInputPage", "futaiEnterKey");
        JSRuntime.InvokeAsync<string>("loadPageScript", "bookingInputPage", "futaiTabKey");
    }

    protected bool IsEnableSaveButton()
    {
        return FormContext.IsModified() && FormContext.Validate();
    }

    private void LoadSelectedDataCombobox(LoadYFutTu yfuttu)
    {
        if (LoadYSeisanList != null && yfuttu.SelectedLoadYSeisan != null)
        {
            yfuttu.SelectedLoadYSeisan =
                LoadYSeisanList.FirstOrDefault(s => s.SeisanCdSeq == yfuttu.SelectedLoadYSeisan.SeisanCdSeq);
        }
        if (yfuttu.FuttumKbnMode == IncidentalViewMode.Futai)
        {
            if (LoadYFutaiList != null && yfuttu.SelectedLoadYFutai != null)
            {
                yfuttu.SelectedLoadYFutai =
                    LoadYFutaiList.FirstOrDefault(s => s.FutaiCdSeq == yfuttu.SelectedLoadYFutai.FutaiCdSeq);
            }
        }
        else if (yfuttu.FuttumKbnMode == IncidentalViewMode.Tsumi)
        {
            if (LoadYTsumiList != null && yfuttu.SelectedLoadYTsumi != null)
            {
                yfuttu.SelectedLoadYTsumi =
                    LoadYTsumiList.FirstOrDefault(s => s.CodeKbnSeq == yfuttu.SelectedLoadYTsumi.CodeKbnSeq);
            }
        }
        if (LoadYRyokinList != null)
        {
            if (yfuttu.SelectedLoadYRyoKin != null)
            {
                yfuttu.SelectedLoadYRyoKin =
                    LoadYRyokinList.FirstOrDefault(s => s.RyoKinTikuCd == yfuttu.SelectedLoadYRyoKin.RyoKinTikuCd && s.RyoKinCd == yfuttu.SelectedLoadYRyoKin.RyoKinCd);
            }
            if (yfuttu.SelectedLoadYShuRyoKin != null)
            {
                yfuttu.SelectedLoadYShuRyoKin =
                    LoadYRyokinList.FirstOrDefault(s => s.RyoKinTikuCd == yfuttu.SelectedLoadYShuRyoKin.RyoKinTikuCd && s.RyoKinCd == yfuttu.SelectedLoadYShuRyoKin.RyoKinCd);
            }
        }
        if (SaveTypeList != null)
        {
            yfuttu.SaveType = SaveTypeList.FirstOrDefault(x=>x.Id== yfuttu.SaveType.Id);
        }
        if (TaxTypeDataList != null && yfuttu.TaxType != null)
        {
            yfuttu.TaxType = TaxTypeDataList.FirstOrDefault(s => s.IdValue == yfuttu.TaxType.IdValue);
        }
        if (FutaiScheduleList != null && yfuttu.ScheduleDate != null)
        {
            yfuttu.ScheduleDate =
                FutaiScheduleList.FirstOrDefault(s => s.Date == yfuttu.ScheduleDate.Date) ?? yfuttu.ScheduleDate;
        }
    }

    protected List<LoadYRyokin> GetLoadYRyokinList()
    {
        var result = LoadYRyokinList.Where(c => string.Compare(c.SiyoStaYmd, LoadYFutTuModel.ScheduleDate.Date.ToString("yyyyMMdd")) <= 0
                                            && string.Compare(c.SiyoEndYmd, LoadYFutTuModel.ScheduleDate.Date.ToString("yyyyMMdd")) >= 0).ToList();
        return result;
    }

    protected List<LoadYRyokin> GetLoadYRyokinList2()
    {
        var result = LoadYRyokinList.Where(c => string.Compare(c.SiyoStaYmd, LoadYFutTuModel.ScheduleDate.Date.ToString("yyyyMMdd")) <= 0
                                            && string.Compare(c.SiyoEndYmd, LoadYFutTuModel.ScheduleDate.Date.ToString("yyyyMMdd")) >= 0).ToList();
        return result;
    }

    #region Handle value change

    protected void HandleSelectedScheduleChanged(ScheduleSelectorModel newValue)
    {
        LoadYFutTuModel.ScheduleDate = newValue;
        var newSettingList = SettingQuantityList
            .Where(s => LoadYFutTuModel.ScheduleDate.Date.IsInRange(s.GarageLeaveDate, s.GarageReturnDate))
            .Select(setting => CommonHelper.SimpleCloneModel<SettingQuantity>(setting))
            .ToList();

        Func<SettingQuantity, object> keySelecter = s => new { s.TeiDanNo, s.UnkRen, s.BunkRen };
        var addedSettingList = newSettingList.Except(LoadYFutTuModel.SettingQuantityList, new SettingQuantityComparer()).ToList();

        LoadYFutTuModel.SettingQuantityList = newSettingList;

        StateHasChanged();
    }

    protected void HandleSelectedYFutaiChanged(LoadYFutai newValue)
    {
        LoadYFutTuModel.SelectedLoadYFutai = newValue;
        LoadYFutTuModel.YFutTuNm = newValue.FutaiNm;

        StateHasChanged();
    }

    protected void HandleLoadYFutTuNmChanged(string newValue)
    {
        LoadYFutTuModel.YFutTuNm = newValue;
        StateHasChanged();
    }

    protected void HandleSelectedTsumiCodeChanged(LoadYTsumi newValue)
    {
        LoadYFutTuModel.SelectedLoadYTsumi = newValue;
        LoadYFutTuModel.YFutTuNm = newValue.CodeKbnNm;

        StateHasChanged();
    }

    protected void HandleSelectedYSeisanChanged(LoadYSeisan newValue)
    {
        LoadYFutTuModel.SelectedLoadYSeisan = newValue;
        LoadYFutTuModel.SeisanNm = newValue.SeisanNm;

        LoadYFutTuModel.SaveType = SaveTypeList.SingleOrDefault(s => s.Id == newValue.SeisanKbn);
        StateHasChanged();
    }

    protected void HandleSelectedYSeisanNmChanged(string newValue)
    {
        LoadYFutTuModel.SeisanNm = newValue;
        StateHasChanged();
    }

    protected void HandleSelectedSaveTypeChanged(YouShaSaveType newValue)
    {
        LoadYFutTuModel.SaveType = newValue;
        StateHasChanged();
    }

    protected void HandleSelectedLoadYRyokinChanged(LoadYRyokin newValue)
    {
        LoadYFutTuModel.SelectedLoadYRyoKin = newValue;
        LoadYFutTuModel.RyokinNm = newValue.RyoKinNm;
        StateHasChanged();
    }

    protected void HandleSelectedYRyokinNmChanged(string newValue)
    {
        LoadYFutTuModel.RyokinNm = newValue;
        StateHasChanged();
    }

    protected void HandleSelectedYShuRyokinChanged(LoadYRyokin newValue)
    {
        LoadYFutTuModel.SelectedLoadYShuRyoKin = newValue;
        LoadYFutTuModel.ShuRyokinNm = newValue.RyoKinNm;
        StateHasChanged();
    }

    protected void HandleSelectedShuRyokinNmChanged(string newValue)
    {
        LoadYFutTuModel.ShuRyokinNm = newValue;
        StateHasChanged();
    }

    protected void HandleSuryoChanged(string newValue)
    {
        LoadYFutTuModel.Suryo = newValue;
        StateHasChanged();
    }

    protected void HandleTankaChanged(string newValue)
    {
        LoadYFutTuModel.Tanka = newValue;
        StateHasChanged();
    }

    protected void HandleTaxTypeChanged(TaxTypeList newValue)
    {
        LoadYFutTuModel.TaxType = newValue;
        StateHasChanged();
    }

    protected void HandleZeiritSuChanged(string newValue)
    {
        if (LoadYFutTuModel.TaxType.IdValue != Constants.NoTax.IdValue)
        {
            LoadYFutTuModel.Zeiritsu = newValue;
        }
        StateHasChanged();
    }

    protected void HandleTesuRituChanged(string newValue)
    {
        LoadYFutTuModel.TesuRitu = newValue;
        StateHasChanged();
    }

    protected void HandleSettingQuantityChanged(string newValue, SettingQuantity settingQuantity)
    {
        settingQuantity.Suryo = newValue;
        StateHasChanged();
    }

    protected void HandleChangeStateSettingQuantity()
    {
        ShowSettingQuantity = !ShowSettingQuantity;
    }

    #endregion

    protected void HandleAddFuttum()
    {
        if (IsEditMode)
        {
            LoadYFutTuOrigin.SimpleCloneProperties(LoadYFutTuModel);
        }
        OnSubmit.InvokeAsync(LoadYFutTuOrigin.YouFutTumRen);
    }

    protected void HandleCancelFuttum()
    {
        OnCancel.InvokeAsync(LoadYFutTuOrigin.YouFutTumRen);
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private CustomHttpClient HttpClient { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AppSettingsService AppSettingsService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IStringLocalizer<YatoiSha> Lang { get; set; }
    }
}
#pragma warning restore 1591
