#pragma checksum "E:\Project\HassyaAllrightCloud\Pages\BusCoordinationReportPreview.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "e42e9a6130d8b961316ea2bc569cbb08568f25b8"
// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace HassyaAllrightCloud.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Globalization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Infrastructure.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Dto;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Helpers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Constants;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Extensions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using BlazorContextMenu;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Application.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.Extensions.Localization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 26 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.IService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot;

#line default
#line hidden
#nullable disable
#nullable restore
#line 30 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor.Reporting;

#line default
#line hidden
#nullable disable
#nullable restore
#line 31 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 32 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 33 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 35 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen;

#line default
#line hidden
#nullable disable
#nullable restore
#line 38 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components.CommonComponents;

#line default
#line hidden
#nullable disable
    public partial class BusCoordinationReportPreview : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 14 "E:\Project\HassyaAllrightCloud\Pages\BusCoordinationReportPreview.razor"
       
    [Parameter] public string SearchString { get; set; }
    [Parameter] public string IsLoadDefault { get; set; }
    [Parameter]
    public string Option { get; set; }
    [Parameter]
    public string UnkobiDate { get; set; }
    [Parameter]
    public string Ukeno { get; set; }
    [Parameter]
    public string UnkRen { get; set; }
    [Parameter]
    public string UkenoList { get; set; } 
    [Parameter]
    public string FormOutput { get; set; } 
    public string reportUrl { get; set; }
    int datetype { get; set; }
    BusCoordinationSearchParam report = new BusCoordinationSearchParam();
    List<ReservationData> reservationlst = new List<ReservationData>();
    IEnumerable<ReservationData> SelectedReservations = new List<ReservationData>();
    List<LoadCustomerList> customerlst = new List<LoadCustomerList>();
    List<SupplierData> supplierlst = new List<SupplierData>();
    List<LoadServiceOffice> salebranchlst = new List<LoadServiceOffice>();
    List<LoadStaffList> stafflst = new List<LoadStaffList>();
    ReservationData allreservation = new ReservationData();
    LoadCustomerList allCustomer = new LoadCustomerList();
    LoadServiceOffice allBranch = new LoadServiceOffice();
    LoadStaffList allStaff = new LoadStaffList();
    protected override async Task OnInitializedAsync()
    {
        if (IsLoadDefault == "1")
        {
            datetype = (int)DateTypeContract.Dispatch;
            report.DateType = datetype;
            reservationlst = await TPM_YoyKbnDataService.GetYoyKbnbySiyoKbn();
            if (reservationlst == null)
            {
                reservationlst = new List<ReservationData>();
            }
            else
            {
                reservationlst.Insert(0, allreservation);
            }
            customerlst = CustomerListService.GetCustomerByDateReport(new ClaimModel().TenantID, report.StartDate.ToString("yyyyMMdd"));
            if (customerlst == null)
            {
                customerlst = new List<LoadCustomerList>();
            }
            else
            {
                customerlst.Insert(0, allCustomer);
            }
            salebranchlst = await ServiceOfficeService.GetBranchReport(new ClaimModel().TenantID);
            if (salebranchlst == null)
            {
                salebranchlst = new List<LoadServiceOffice>();
            }
            else
            {
                salebranchlst.Insert(0, allBranch);
            }
            stafflst = await StaffListService.GetStaffReport(new ClaimModel().TenantID, report.StartDate.ToString("yyyyMMdd"));
            if (stafflst == null)
            {
                stafflst = new List<LoadStaffList>();
            }
            else
            {
                stafflst.Insert(0, allStaff);
            }
            if (!string.IsNullOrEmpty(Option) && !string.IsNullOrEmpty(Ukeno)
            && (Option == OptionReport.Preview.ToString() || Option == OptionReport.Download.ToString()) && !string.IsNullOrEmpty(UnkRen))
            {
                DateTime dateTimeConvert;
                try
                {

                    if (string.IsNullOrEmpty(UnkobiDate))
                    {
                        dateTimeConvert = await CoordinationReportService.GetUnkobiDate(Ukeno, UnkRen);
                        report.StartDate = dateTimeConvert;
                        report.EndDate = dateTimeConvert;
                    }
                    else
                    {
                        dateTimeConvert = DateTime.ParseExact(UnkobiDate, "yyyyMMdd", new CultureInfo("ja-JP"));
                        report.StartDate = dateTimeConvert;
                        report.EndDate = dateTimeConvert;
                    }

                    report.BookingFrom = Ukeno;
                    report.BookingTo = Ukeno;
                    report.UnkRen = short.Parse(UnkRen);
                }
                catch(Exception ex)
                {

                }

                Load();
                var searchStringDefault = EncryptHelper.EncryptToUrl(report);
                reportUrl = $"{nameof(IBusCoordinationReportService)}?{searchStringDefault}";
            }
            if(!string.IsNullOrEmpty(UkenoList))
            {
                DatetimeData datetimeData = new DatetimeData();
                datetimeData = await CoordinationReportService.GetUnkobiDatebyUkenoList(UkenoList);
                report.StartDate = datetimeData.DateStart;
                report.EndDate = datetimeData.DateEnd;
                report.UkenoList = UkenoList;
                Load();
                var searchStringDefault = EncryptHelper.EncryptToUrl(report);
                reportUrl = $"{nameof(IBusCoordinationReportService)}?{searchStringDefault}";
            }
        }
        else if (!string.IsNullOrEmpty(SearchString))
        {
            reportUrl = $"{nameof(IBusCoordinationReportService)}?{SearchString}";
        }
        NavManager.NavigateTo("/BusCoordinationReportPreview", false);
    }
    void Load()
    {
        if (reservationlst.Count >= 1)
        {
            SelectedReservations = reservationlst;
            report.ReservationList = SelectedReservations.Select(t=>t.YoyaKbnSeq).ToList();
        }
        if (customerlst.Count >= 1)
        {
            report.CustomerStart = customerlst.First();
            report.CustomerEnd = customerlst.First();
            report.CustomerStart01 = customerlst.First();
            report.CustomerEnd01 = customerlst.First();
        }
        if (salebranchlst.Count >= 1)
        {
            report.SaleBranch = salebranchlst.First();
        }
        if (stafflst.Count >= 1)
        {
            report.Staff = stafflst.First();
            report.PersonInput = stafflst.First();
        }
    }

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IBusCoordinationReportService CoordinationReportService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private CustomNavigation NavManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ITPM_YoyKbnDataListService TPM_YoyKbnDataService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IStaffListService StaffListService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IServiceOfficeService ServiceOfficeService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ICustomerListService CustomerListService { get; set; }
    }
}
#pragma warning restore 1591
