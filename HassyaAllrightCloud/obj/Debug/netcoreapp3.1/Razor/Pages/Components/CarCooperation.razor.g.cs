#pragma checksum "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "759eafde9b21fdde65baa60cd84abb58e046b63c"
// <auto-generated/>
#pragma warning disable 1591
namespace HassyaAllrightCloud.Pages.Components
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Globalization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Infrastructure.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Domain.Dto;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Helpers;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Constants;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Commons.Extensions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using BlazorContextMenu;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Application.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Validation;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 22 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 23 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 24 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Newtonsoft.Json.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 25 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Microsoft.Extensions.Localization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 26 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.IService;

#line default
#line hidden
#nullable disable
#nullable restore
#line 27 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 28 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 29 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using LexLibrary.Line.NotifyBot;

#line default
#line hidden
#nullable disable
#nullable restore
#line 30 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using DevExpress.Blazor.Reporting;

#line default
#line hidden
#nullable disable
#nullable restore
#line 31 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 32 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 33 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal;

#line default
#line hidden
#nullable disable
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Blazored.Modal.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 35 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using SharedLibraries.UI.Models;

#line default
#line hidden
#nullable disable
#nullable restore
#line 37 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen;

#line default
#line hidden
#nullable disable
#nullable restore
#line 38 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using Radzen.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 39 "E:\Project\HassyaAllrightCloud\_Imports.razor"
using HassyaAllrightCloud.Pages.Components.CommonComponents;

#line default
#line hidden
#nullable disable
    public partial class CarCooperation : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenElement(0, "div");
            __builder.AddAttribute(1, "class", "form-group d-flex flex-nowrap align-items-center");
            __builder.AddMarkupContent(2, "\r\n    ");
            __builder.OpenElement(3, "label");
            __builder.AddAttribute(4, "class", "col-form-label-sm mr-3 width--75 ");
            __builder.AddContent(5, 
#nullable restore
#line 9 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                      Lang["car_destination"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(6, "   \r\n    ");
            __builder.OpenElement(7, "p");
            __builder.AddAttribute(8, "class", "mb-0");
            __builder.AddContent(9, 
#nullable restore
#line 10 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                      carCooperationData.TOKISK_RyakuNm+"　"+carCooperationData.TOKIST_RyakuNm

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(10, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(11, "\r\n");
            __builder.OpenElement(12, "div");
            __builder.AddAttribute(13, "class", "form-group d-flex flex-nowrap align-items-center");
            __builder.AddMarkupContent(14, "\r\n    ");
            __builder.OpenElement(15, "label");
            __builder.AddAttribute(16, "class", "col-form-label-sm mr-3 width--75 ");
            __builder.AddContent(17, 
#nullable restore
#line 13 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                      Lang["receipt_number"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(18, "\r\n    ");
            __builder.OpenElement(19, "p");
            __builder.AddAttribute(20, "class", "mb-0");
            __builder.AddContent(21, 
#nullable restore
#line 14 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                     carCooperationData.UkeCd.ToString("D10")

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(22, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(23, "\r\n");
            __builder.OpenElement(24, "div");
            __builder.AddAttribute(25, "class", "form-group d-flex flex-nowrap align-items-center");
            __builder.AddMarkupContent(26, "\r\n    ");
            __builder.OpenElement(27, "label");
            __builder.AddAttribute(28, "class", "col-form-label-sm mr-3 width--75 ");
            __builder.AddContent(29, 
#nullable restore
#line 17 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                      Lang["group_name"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(30, "\r\n    ");
            __builder.OpenElement(31, "p");
            __builder.AddAttribute(32, "class", "mb-0");
            __builder.AddContent(33, 
#nullable restore
#line 18 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                     carCooperationData.DanTaNm

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(34, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(35, "\r\n");
            __builder.OpenElement(36, "div");
            __builder.AddAttribute(37, "class", "form-group d-flex flex-nowrap align-items-center");
            __builder.AddMarkupContent(38, "\r\n    ");
            __builder.OpenElement(39, "label");
            __builder.AddAttribute(40, "class", "col-form-label-sm mr-3 width--75 ");
            __builder.AddContent(41, 
#nullable restore
#line 21 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                      Lang["service_datetime"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\r\n    ");
            __builder.OpenElement(43, "p");
            __builder.AddAttribute(44, "class", "mb-0");
            __builder.AddContent(45, 
#nullable restore
#line 22 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                     date

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(46, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(47, "\r\n");
            __builder.OpenElement(48, "div");
            __builder.AddAttribute(49, "class", "form-group d-flex flex-nowrap align-items-center");
            __builder.AddMarkupContent(50, "\r\n    ");
            __builder.OpenElement(51, "label");
            __builder.AddAttribute(52, "class", "col-form-label-sm mr-3 width--75 ");
            __builder.AddContent(53, 
#nullable restore
#line 25 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                      Lang["number_of_car"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(54, "\r\n    ");
            __builder.OpenElement(55, "div");
            __builder.AddAttribute(56, "class", "d-flex flex-nowrap flex-grow-1 align-items-center list-number-car");
            __builder.AddMarkupContent(57, "\r\n        ");
            __builder.OpenElement(58, "div");
            __builder.AddContent(59, 
#nullable restore
#line 27 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
               carCooperationData.LargeCount >0  ? "大型　"+carCooperationData.LargeCount+"台" : null

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(60, "\r\n        ");
            __builder.OpenElement(61, "div");
            __builder.AddContent(62, 
#nullable restore
#line 28 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
               carCooperationData.MediumCount >0  ? "中型　"+carCooperationData.MediumCount+"台" : null

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(63, "\r\n        ");
            __builder.OpenElement(64, "div");
            __builder.AddContent(65, 
#nullable restore
#line 29 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
               carCooperationData.SmallCount >0  ? "小型　"+carCooperationData.SmallCount+"台" : null

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(66, "\r\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(67, "\r\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(68, "　　　　　\r\n");
            __builder.OpenElement(69, "div");
            __builder.AddAttribute(70, "class", "text-center");
            __builder.AddMarkupContent(71, "\r\n    ");
            __builder.OpenElement(72, "button");
            __builder.AddAttribute(73, "type", "button");
            __builder.AddAttribute(74, "class", "btn btn-sm btn-outline-dark width--140 mx-2");
            __builder.AddAttribute(75, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 33 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                                                          (e) => Cancel(e)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(76, 
#nullable restore
#line 33 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                                                                              Lang["btn_cancel"]

#line default
#line hidden
#nullable disable
            );
            __builder.CloseElement();
            __builder.AddMarkupContent(77, "\r\n    ");
            __builder.OpenComponent<DevExpress.Blazor.DxButton>(78);
            __builder.AddAttribute(79, "RenderStyle", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<DevExpress.Blazor.ButtonRenderStyle>(
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                           ButtonRenderStyle.Primary

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(80, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                                  () => OpenPopupInformation(CloseAndOpenMessage)

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(81, "Text", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.String>(
#nullable restore
#line 34 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
                                                                                                                           Lang["btn_go"]

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(82, "CssClass", "width--90 mx-2");
            __builder.CloseComponent();
            __builder.AddMarkupContent(83, "\r\n");
            __builder.CloseElement();
        }
        #pragma warning restore 1998
#nullable restore
#line 37 "E:\Project\HassyaAllrightCloud\Pages\Components\CarCooperation.razor"
       
    [Parameter] public string UkeNo { get; set; }
    [Parameter] public short UnkRen { get; set; }
    [Parameter] public int YouTblSeq { get; set; }
    [Parameter] public EventCallback<Dictionary<string, dynamic>> OnClosePopup { get; set; }
    private CarCooperationData carCooperationData = new CarCooperationData();
    private TenantGroupData tenantGroupDataReception = new TenantGroupData();
    private TenantGroupData tenantGroupDataReceptionCustomer = new TenantGroupData();
    private ClientData clientData = new ClientData();
    DateTime minDate = new DateTime();
    DateTime maxDate = new DateTime();
    string date = "";
    bool CloseAndOpenMessage { get; set; } = true;
    string baseUrl;
    #region Component Lifecycle
    /// <summary>
    ///
    /// </summary>
    /// <returns></returns>
    protected override async Task OnInitializedAsync()
    {
        carCooperationData = await CarCooperationService.Getdata(UkeNo, UnkRen, YouTblSeq);
        if(carCooperationData!=null)
        {
            tenantGroupDataReception = await TenantGroupService.GetdataReception(new ClaimModel().TenantID, carCooperationData.TokuiSeq, carCooperationData.SitenCdSeq);
            if(tenantGroupDataReception!=null)
            {
                tenantGroupDataReceptionCustomer = await TenantGroupService.GetdataReceptionCustomer(tenantGroupDataReception.SitenCdSeqTenantCdSeq, tenantGroupDataReception.TenantGroupCdSeq, tenantGroupDataReception.TenantCdSeq);
                if(tenantGroupDataReceptionCustomer!=null)
                {
                    carCooperationData.MotoTokuiSeq = tenantGroupDataReceptionCustomer.TokuiSeq;
                    carCooperationData.MotoSitenCdSeq = tenantGroupDataReceptionCustomer.SitenCdSeq;
                }
                carCooperationData.UkeTenantCdSeq = tenantGroupDataReception.SitenCdSeqTenantCdSeq;
            }

            DateTime.TryParseExact(carCooperationData.MinDate+carCooperationData.MinTime,
                              "yyyyMMddHHmm",
                              CultureInfo.CurrentCulture,
                              DateTimeStyles.None,
                              out minDate);
            DateTime.TryParseExact(carCooperationData.MaxDate+carCooperationData.MaxTime,
                              "yyyyMMddHHmm",
                              CultureInfo.CurrentCulture,
                              DateTimeStyles.None,
                              out maxDate);
            date=minDate.ToString("yyyy年MM月dd日 (ddd) HH:mm") +"　～　"+ maxDate
                .ToString("yyyy年MM月dd日 (ddd) HH:mm");
        }
    }
    /// <summary>
    /// 
    /// </summary>
    /// <param name="value"></param>
    /// <returns></returns>
    public async Task OpenPopupInformation(bool value)
    {
        try
        {
            if(carCooperationData.UkeTenantCdSeq==0|| carCooperationData.MotoTokuiSeq==0|| carCooperationData.MotoSitenCdSeq==0)
            {
                var parameter = new Dictionary<string, dynamic>();
                parameter.Add("OpenPopup", value);
                parameter.Add("Status", "Error");
                await OnClosePopup.InvokeAsync(parameter);
            }
            else
            {
                baseUrl = AppSettingsService.GetBaseUrl();
                var client = await Http.GetHttpClient();
                HttpResponseMessage response = await client.PostAsync($"{baseUrl}/api/TkdYoushaNotice/", Http.getStringContentFromObject(carCooperationData));
                if ((int)response.StatusCode == 200)
                {
                    clientData = await TenantGroupService.GetClienData(carCooperationData.UkeTenantCdSeq, carCooperationData.MotoTokuiSeq, carCooperationData.MotoSitenCdSeq);
                    List<string> emailLst = new List<string>();
                    emailLst.Add(carCooperationData.TokuiMail);
                    string ukeTenant = await TenantGroupService.GetTenantName(carCooperationData.UkeTenantCdSeq);
                    string emailSubject = string.Format(Lang["emailSubject"], DateTime.Now.ToString("yyyy年MM月dd日 (ddd) HH:mm"),carCooperationData.TokuiMail, carCooperationData.UkeCd.ToString("D10"));
                    string emailcontent = string.Format(Lang["emailContent"], ukeTenant, "kidoku", carCooperationData.UkeCd.ToString("D10"), carCooperationData.DanTaNm, minDate.ToString("yyyy年MM月dd日 (ddd) HH:mm"), maxDate
                            .ToString("yyyy年MM月dd日 (ddd) HH:mm"), clientData.TokuiCd.ToString("D4"), clientData.TokuiNm, clientData.SitenCd.ToString("D4"), clientData.SitenNm, carCooperationData.LargeCount, carCooperationData.MediumCount, carCooperationData.SmallCount, "kidoku");
                    try
                    {
                        var sentmail = await NotificationToStaffService.SendMail(emailLst, emailSubject, emailcontent);
                    }
                    catch (Exception ex)
                    {
                        Console.WriteLine(ex.Message);
                        //TODO use logger to log down exception ex.message
                    }
                    var parameter = new Dictionary<string, dynamic>();
                    parameter.Add("OpenPopup", value);
                    parameter.Add("Status", "Success");
                    await OnClosePopup.InvokeAsync(parameter);
                }
                else
                {
                    var parameter = new Dictionary<string, dynamic>();
                    parameter.Add("OpenPopup", value);
                    parameter.Add("Status", "Error");
                    await OnClosePopup.InvokeAsync(parameter);
                }
            }

        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
            //TODO use logger to log down exception ex.message
        }


    }

    public async Task ClosePopupCarCooperation(bool value)
    {

    }
    /// <summary>
    /// 
    /// </summary>
    /// <param name="e"></param>
    /// <returns></returns>
    private async Task Cancel(MouseEventArgs e)
    {
        var parameter = new Dictionary<string, dynamic>();
        parameter.Add("OpenPopup", false);
        parameter.Add("Status", "Error");
        await OnClosePopup.InvokeAsync(parameter);
    }
    #endregion

#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private INotificationToStaffService NotificationToStaffService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AppSettingsService AppSettingsService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private CustomHttpClient Http { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ITenantGroupServiceService TenantGroupService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private ICarCooperationListService CarCooperationService { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IStringLocalizer<CarCooperation> Lang { get; set; }
    }
}
#pragma warning restore 1591
