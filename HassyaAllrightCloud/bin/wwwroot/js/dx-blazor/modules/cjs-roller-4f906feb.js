_dxBlazorInternal.define("cjs-roller-4f906feb.js",function(t,e,i){t("./cjs-chunk-c43b3f7c.js");var n=t("./cjs-dom-utils-6a09eac3.js"),r=t("./cjs-chunk-7aa0d757.js");function s(t){return t*(2-t)}var o=function(){this.subscribers=[]};o.prototype.subscribe=function(t){-1===this.subscribers.indexOf(t)&&this.subscribers.push(t)},o.prototype.unsubscribe=function(t){var e=this.subscribers.indexOf(t);-1!==e&&this.subscribers.splice(e,1)},o.Empty=new o;var a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.emit=function(t){this.subscribers.forEach(function(e){return e(t)})},e}(o),u=function(t){function e(e){t.call(this),this.isInitialized=1===arguments.length,this.value=e}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.update=function(t){this.isInitialized&&t===this.value||(this.isInitialized=!0,this.value=t,this.subscribers.forEach(function(e){return e(t)}))},e.prototype.subscribe=function(e,i){this.isInitialized&&!i&&e(this.value),t.prototype.subscribe.call(this,e)},e.prototype.asTrigger=function(t){var i=new e;return this.subscribe("function"!=typeof t?function(e){return i.update(-1!==t.indexOf(e))}:function(e){return i.update(t(e))}),i},e.prototype.or=function(t){var i=this,n=new e;return this.subscribe(function(e){return n.update(e||t.value)}),t.subscribe(function(t){return n.update(i.value||t)}),n},e.prototype.and=function(t){var i=this,n=new e;return this.subscribe(function(e){return n.update(e&&t.value)}),t.subscribe(function(t){return n.update(i.value&&t)}),n},e.prototype.join=function(t){var i=this,n=new e;return this.subscribe(function(e){return n.update([e,t.value])}),t.subscribe(function(t){return n.update([i.value,t])}),n},e}(o);function l(t){return t/Math.abs(t)}function c(t,e,i,n){var r=null;function s(t){return r?r(t):0}function o(){r=null}function a(t,n,s){r=function(t,e,i,n,r){var s=e+i,o=0;return function(a,u){if(u)return u(t-o,a,n(a/s));a>=s&&r&&r();var l=t*n((Math.min(a,s)-e)/i)-o;return o+=l,l}}(n+t,s,e,i,o)}function u(t){null===r?(a(t.value,0,t.timeStamp),n(s)):r(t.timeStamp,function(e,i){return a(t.value,e,i)})}return t.subscribe(u),function(){r=null,t.unsubscribe(u)}}function h(t,e,i,r,s){var o,u,h,m,p,f=function(t,e,i){var n=new a;return t.addEventListener(e,function(t){t.preventDefault();var e=i(t);0===e||isNaN(e)||n.emit({value:e,timeStamp:t.timeStamp})},!1),n}(t,"wheel",function(t){return l(t.deltaY)*e});c((o=f,u=30,h=new a,m=0,p=1,o.subscribe(function(t){(0===m||t.timeStamp>=m||l(t.value)!==p)&&(m=t.timeStamp+u,p=l(t.value),h.emit(t))}),h),300,i,function(t){s(new Promise(function(e,i){!function t(e,i){n.RequestAnimationFrame(function(n){var s=e(n);0!==s?(r(s),t(e,i)):i()})}(t,e)}))})}function m(t,e,i){var n=i(t);return n?e||n.visible.value?n:m(n,e,i):null}function p(t,e){var i,n,r=-1===e?"prevItem":"nextItem";return t[r]?t[r]:t[r]=(n=t.value+e*(i=t.collection).delta,-1===e&&-1!==i.min&&n<i.min?new d(i,i.max,!1,null,t):1===e&&-1!==i.max&&n>i.max?new d(i,i.min,!1,t,null):new d(i,n,!1))}var f=function(t,e,i,n,r,s){var o=this;this.collection=t,this.prevItem=r,this.nextItem=s,this.value=e,this.visible=i||new u(!0),this.selected=new u(!!n),r&&(r.nextItem=this),s&&(s.prevItem=this),this.displayText=new u(e);var a=this.collection.selectedItem;this.selected.subscribe(function(t){t&&(a.value&&a.value.selected.update(!1),a.update(o))}),this.visible.subscribe(function(t){!t&&o.selected.value&&o.getPrevious().selected.update(!0),o.collection.visibleItemsChanged.emit()},!0)};f.prototype.getPrevious=function(t){return m(this,t,function(t){return t.prevItem})},f.prototype.getNext=function(t){return m(this,t,function(t){return t.nextItem})},f.prototype.getDisplayText=function(){return this.displayText.value||this.value};var d=function(t){function e(e,i,n,r,s){t.call(this,e,i,null,n,r,s)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getPrevious=function(t){return p(this,-1)},e.prototype.getNext=function(t){return p(this,1)},e}(f),v=function(t){function e(e,i){t.call(this,e,i,!0)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(d),b=function(){this.items=[],this.selectedItem=new u,this.visibleItemsChanged=new a};b.createMonthCollection=function(t,e){for(var i=new b,n=0;n<e.length;n++)i.add(n+1,null,n+1===t).displayText.value=e[n];return i.initialize(t),i},b.createGenerator=function(t,e,i,n){var r=new y(e,i,n);return r.initialize(t),r},b.prototype.initialize=function(t){this.items[0].prevItem=this.items[this.items.length-1],this.items[this.items.length-1].nextItem=this.items[0],this.items.filter(function(e){return e.value===t})[0].selected.update(!0)},b.prototype.add=function(t,e,i){var n=new f(this,t,e,i,this.items[this.items.length-1]);return this.items.push(n),n};var y=function(t){function e(e,i,n){t.call(this),this.min=e,this.max=i,this.delta=n,this.originItem=null}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.initialize=function(t){this.originItem=new v(this,t)},e}(b),g=function(t,e,i,n,r){this.displayTextSubscription=this.displayTextSubscription.bind(this),this.roller=i,this.prevItem=r,this.nextItem=null,this.index=e,this.elements=i.createRollerItemElements(),this.offset=e*n,this.height=n,this.position=0,this.visibleItemCount=i.visibleItemCount,r&&(r.nextItem=this),this.updateDataItem(t),this.selectItem=this.selectItem.bind(this)};function I(t,e){t.innerText=e}function C(t,e,i){var n=i(t);return Math.abs(Math.round(n.position-t.position))===e?[n].concat(C(n,e,i)):[]}function x(t,e,i){0!==t.length&&(t.shift().updateDataItem(e),x(t,i(e),i))}g.prototype.initialize=function(t){var e=this,i=Math.floor(this.visibleItemCount/2);this.elements[1].style.top=(this.index-i)*this.height+"px",t.appendChild(this.elements[1]),this.move(this.offset),this.elements[0].addEventListener("click",function(t){n.RequestAnimationFrame(e.selectItem)})},g.prototype.isSelected=function(){return Math.floor(this.visibleItemCount/2)*this.height===Math.round(this.position)},g.prototype.selectItem=function(t){var e=this,i=Math.floor(this.visibleItemCount/2);return this.roller.afterMove(S(o.Empty,function(t){return e.roller.move(t)},{divisor:this.roller.itemSize.height,startTimestamp:t,endTimestamp:t+300,easing:s,frameCallback:n.RequestAnimationFrame,value:(i-this.index)*this.height-(this.position-this.offset)}))},g.prototype.move=function(t){this.updatePosition(t);var e=this.position-this.offset;this.elements.forEach(function(t){return t.style.transform="matrix(1, 0, 0, 1, 0, "+e+")"})},g.prototype.updatePosition=function(t){this.position+=t,this.position>this.visibleItemCount*this.height?(this.position-=(this.visibleItemCount+1)*this.height,this.updateDataItem(this.nextItem.dataItem.getPrevious())):this.position<-1*this.height&&(this.position+=(this.visibleItemCount+1)*this.height,this.updateDataItem(this.prevItem.dataItem.getNext()))},g.prototype.updateDataItem=function(t){this.dataItem!==t&&(this.dataItem&&this.dataItem.displayText.unsubscribe(this.displayTextSubscription),this.dataItem=t,this.dataItem.displayText.subscribe(this.displayTextSubscription))},g.prototype.displayTextSubscription=function(t){this.elements.forEach(function(e){return I(e,t)})},g.prototype.raiseChanges=function(){this.isSelected()&&this.dataItem.selected.update(!0)};var w=function(t,e,i,n,r,s){this.itemCollection=t,this.visibleItemCount=e,this.itemContainers=[],this.itemSize=n,this.caption=r,this.longestVisibleDisplayText=s,this.container=i,this.rollerElement=null,this.rollerContainer=null,this.move=this.move.bind(this),this.afterMove=this.afterMove.bind(this)};function S(t,e,i){return new Promise(function(n,r){function s(){t.unsubscribe(s),r()}t.subscribe(s,!0);var o=0,a=i.frameCallback;a(function r(u){if(u<i.endTimestamp){var l=i.easing((u-i.startTimestamp)/(i.endTimestamp-i.startTimestamp)),c=i.value*l-o;e(c),o+=c,a(r)}else t.unsubscribe(s),e(i.value-o),n()})})}function N(t,e,i,n,r,o){var a,u,l,c,h=1,m=i.accelerationTimeFrame||300;function p(t){u=0,l=t,h=1}t.subscribe(function(f){o(function(d){c||(c=!0,p(d),r(new Promise(function(r,a){e.subscribe(function a(l){e.unsubscribe(a),S(t,n,function(t){var e=Math.abs(u%i.divisor);return{value:(i.divisor-e)*Math.sign(u),endTimestamp:t+300,startTimestamp:t,easing:s,frameCallback:o}}(l)).then(function(){c=!1,r()}).catch(function(){e.subscribe(a)}).finally(p)})}))),n(function(t,e){return(e*=h)>=a&&t-l<=m&&(h=Math.min(2,1.2*h)),u+=e,a=e,l=t,e}(d,f))})})}function T(t){return t.value%4==0}function D(t){return 2!==t.value}function E(t){return-1!==[1,3,5,7,8,10,12].indexOf(t.value)}w.prototype.initialize=function(){var t=this;this.initializeRollerElements();for(var e=[this.itemCollection.selectedItem.value];e.length<this.visibleItemCount;)e.splice(0,0,e[0].getPrevious()),e.push(e[e.length-1].getNext());e.push(e[e.length-1].getNext());for(var i=0;i<e.length;i++)this.itemContainers.push(new g(e[i],i,this,this.itemSize.height,this.itemContainers[this.itemContainers.length-1]));this.longestVisibleDisplayText&&I(this.createRollerItemElement("roller-item expander"),this.longestVisibleDisplayText);var o=this.createRollerItemElement("roller-after");this.itemContainers[0].prevItem=this.itemContainers[this.itemContainers.length-1],this.itemContainers[this.itemContainers.length-1].nextItem=this.itemContainers[0];for(i=0;i<this.itemContainers.length;i++)this.itemContainers[i].initialize(o);this.itemCollection.selectedItem.subscribe(function(){return t.updateVisibleDataItems()},!0),this.itemCollection.visibleItemsChanged.subscribe(function(){return t.updateVisibleDataItems()},!0),h(this.rollerElement,this.itemSize.height,s,this.move,this.afterMove),function(t,e,i,r){var s=new a,o=new a,u=0;t.addEventListener("touchstart",function(t){u=t.touches[0].clientY},!1),t.addEventListener("touchend",function(t){u=0,n.RequestAnimationFrame(function(t){return o.emit(t)})},!1),t.addEventListener("touchmove",function(t){t.preventDefault();var e=t.changedTouches[0].clientY;s.emit(e-u),u=e},!1),N(s,o,{divisor:e},i,r,n.RequestAnimationFrame)}(this.rollerElement,this.itemSize.height,this.move,this.afterMove),this.rollerContainer.addEventListener("keydown",function(e){var i=null;e.keyCode===r.Key.Up?i=t.itemCollection.selectedItem.value.getNext():e.keyCode===r.Key.Down&&(i=t.itemCollection.selectedItem.value.getPrevious()),i&&(e.preventDefault(),i.selected.update(!0))})},w.prototype.initializeRollerElements=function(){var t=this.rollerContainer=document.createElement("A");t.className="roller-container",t.href="javascript:;",t.style.minWidth=this.itemSize.width;var e=document.createElement("SPAN");e.innerText=this.caption,e.className="roller-title",t.appendChild(e);var i=this.rollerElement=document.createElement("SPAN");i.className="roller",t.appendChild(i),this.container&&this.container.appendChild(t)},w.prototype.updateVisibleDataItems=function(){var t=this.itemContainers.filter(function(t){return t.isSelected()})[0];if(t){var e=C(t,this.itemSize.height,function(t){return t.prevItem}),i=C(t,this.itemSize.height,function(t){return t.nextItem}),n=this.itemCollection.selectedItem.value;t.updateDataItem(n),x(e.concat([]),n.getPrevious(),function(t){return t.getPrevious()}),x(i.concat([]),n.getNext(),function(t){return t.getNext()})}},w.prototype.createRollerItemElement=function(t){var e=document.createElement("SPAN");return e.className=t||"roller-item",this.rollerElement.appendChild(e),e},w.prototype.createRollerItemElements=function(){var t=this.createRollerItemElement();return[t,t.cloneNode()]},w.prototype.move=function(t){if(0!==t)for(var e=Math.sign(t),i=this.itemContainers.length-1,n=(-1===e?0:i)+e,r=-1===e?i:0;r!==n;r+=e)this.itemContainers[r].move(t)},w.prototype.afterMove=function(t){var e=this;return t.then(function(){return Promise.resolve(e.itemContainers.forEach(function(t){return t.raiseChanges()}))})};var M={Day:0,DayWithShortName:1,DayWithFullName:2,MonthWithShortName:3,MonthWithFullName:4,Year:5};function z(t,e,i,n,r,s){var o=t.add(e,i,n);r.length>0&&s.subscribe(function(t){var i=r[j(t[1].value,t[0].value,e)];o.displayText.update(e+" "+i)})}function j(t,e,i){return new Date(t,e-1,i).getDay()}function _(t){return t&&t.length?" "+t.concat([]).sort(function(t,e){return e.length-t.length})[0]:""}var P={InitializeDateRoller:function(t,e,i){for(var n=e.items.filter(function(t){return t.type===M.DayWithShortName||t.type===M.DayWithFullName||t.type===M.Day})[0].value,r=e.items.filter(function(t){return t.type===M.MonthWithShortName||t.type===M.MonthWithFullName})[0].value,s=e.items.filter(function(t){return t.type===M.Year})[0].value,o=e.monthNames||[],a=e.dayNames||[],u=b.createGenerator(s,-1,-1,1),l=b.createMonthCollection(r,o),c=l.selectedItem.asTrigger(D),h={29:u.selectedItem.asTrigger(T).or(c),30:c,31:l.selectedItem.asTrigger(E)},m=l.selectedItem.join(u.selectedItem),p=new b,f=1;f<=31;f++)z(p,f,h[f],f===n,a,m);p.initialize(n);var d=document.createDocumentFragment(),v=document.createElement("STYLE");function y(t){return function(e){t(e),i.invokeMethodAsync("UpdateDateTime",[n,r,s])}}return v.type="text/css",v.innerText=".roller { height: 180px; } .roller-item, .roller-after { height: 36px; } .roller-item, .roller-title { color: "+getComputedStyle(t).color+" !important; } .roller-after { background-color: "+getComputedStyle(t.parentNode.parentNode).backgroundColor+";}",d.appendChild(v),e.items.forEach(function(t){switch(t.type){case M.Day:case M.DayWithFullName:case M.DayWithShortName:new w(p,5,d,{width:"",height:36},"Day","25"+_(a)).initialize();break;case M.MonthWithFullName:case M.MonthWithShortName:new w(l,5,d,{width:"",height:36},"Month",_(o)).initialize();break;case M.Year:new w(u,5,d,{width:"",height:36},"Year","0000").initialize()}}),t.appendChild(d),p.selectedItem.subscribe(y(function(t){n=t.value})),l.selectedItem.subscribe(y(function(t){r=t.value})),u.selectedItem.subscribe(y(function(t){s=t.value})),Promise.resolve()}};i.Roller=w,i.RollerItem=f,i.RollerItemCollection=b,i.attachInputSource=N,i.default=P,i.getDayOfWeek=j},["cjs-chunk-c43b3f7c.js","cjs-dom-utils-6a09eac3.js","cjs-chunk-7aa0d757.js"]);
