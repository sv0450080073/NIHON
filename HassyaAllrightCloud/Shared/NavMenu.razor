@using Microsoft.Extensions.Configuration
@using Microsoft.AspNetCore.Hosting
@using Microsoft.Extensions.Hosting
@inject IConfiguration Configuration
@inject IJSRuntime JSRuntime
@inject NavigationManager NavManager
@inject IStringLocalizer<NavMenu> Lang
@inject IWebHostEnvironment HostEnvironment

@*<NavLink href="home">
    <div class="sidebar-header">
    <img src="images/logo.png" alt="Logo" /> @Lang["PageTitle"]
    </div>
    </NavLink>*@

<KoboMenu MenuItems="KoboMenuItems" ServiceEndpoints="serviceEndpoints" IsMinimize="IsMinimize"
    LogoUrl="images/logo.png" LogoTitle="@Lang["PageTitle"]" HomeUrl="home"></KoboMenu>

@*<div class="sidebar-content scrollbar-macosx">

    </div>*@

<!--<div class="sidebar-content scrollbar-macosx">
    <ul class="list-unstyled components">
        <li>
            <NavLink href="#menu1Submenu" data-toggle="collapse" aria-expanded="true" class="dropdown-toggle"><i class="fa fa-home mr-2"></i>@Lang["Menu1"]</NavLink>
            <ul class="collapse show list-unstyled" id="menu1Submenu">
                <li>
                    <NavLink href="#menu2Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-1"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu2Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="home">@Lang["Menu1-1-1"]</NavLink></li>
                        <li><NavLink href="bookinginput" @onclick="OnClickToIndex" Match="NavLinkMatch.All">@Lang["Menu1-2-1"]</NavLink></li>
                        <li><NavLink href="busschedule">@Lang["Menu1-1-2"]</NavLink></li>
                        <li><NavLink href="hypermenu">@Lang["Menu1-1-3"]</NavLink></li>
                        <li><NavLink href="staffschedule">@Lang["Menu1-3-5"]</NavLink></li>
                    </ul>
                </li>-->
@*<li>
    <NavLink href="#menu30Submenu" data-toggle="collapse" aria-expanded="false"
    class="dropdown-toggle">@Lang["Menu1-8"]</NavLink>
    <ul class="collapse list-unstyled" id="menu30Submenu" data-parent="#menu1Submenu">
    <li>
    <NavLink href="#menu31Submenu" data-toggle="collapse" aria-expanded="false"
    class="dropdown-toggle">@Lang["Menu1-8-1"]</NavLink>
    <ul class="collapse list-unstyled" id="menu31Submenu" data-parent="#menu30Submenu">
    <li><NavLink href="simplequotation">@Lang["Menu1-8-1-1"]</NavLink></li>
    <li><NavLink href="quotationwithjourney">@Lang["Menu1-8-1-2"]</NavLink></li>
    </ul>
    </li>
    </ul>
    </li>*@
<!--<li>
                    <NavLink href="#menu5Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-2"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu5Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="bookinginput" @onclick="OnClickToIndex" Match="NavLinkMatch.All">@Lang["Menu1-2-1"]</NavLink></li>
                        <li><NavLink href="busschedule">@Lang["Menu1-1-2"]</NavLink></li>
                        <li><NavLink href="hypermenu">@Lang["Menu1-1-3"]</NavLink></li>
                        <li><NavLink href="bustypelist">@Lang["Menu1-1-4"]</NavLink></li>
                        <li>
                            <NavLink href="#menu6Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-2-2"]</NavLink>
                            <ul class="collapse list-unstyled" id="menu6Submenu" data-parent="#menu5Submenu">
                                <li><NavLink href="transportationcontract">@Lang["Menu1-2-2-1"]</NavLink></li>
                                <li><NavLink href="buscoordination">@Lang["Menu1-2-2-2"]</NavLink></li>
                                <li><NavLink href="statusconfirmation">@Lang["Menu1-2-2-3"]</NavLink></li>
                                <li><NavLink href="subcontractorstatus">@Lang["Menu1-2-2-4"]</NavLink></li>
                                <li><NavLink href="venderrequestform">@Lang["Menu1-2-2-5"]</NavLink></li>
                                <li><NavLink href="accessoryfeelist">@Lang["Menu1-2-2-6"]</NavLink></li>
                                <li><NavLink href="cancellist">@Lang["Menu1-2-2-7"]</NavLink></li>
                                <li><NavLink href="faresupperandlowerlimits">@Lang["Menu1-2-2-8"]</NavLink></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu7Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-3"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu7Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="busallocation">@Lang["Menu1-3-1"]</NavLink></li>
                        <li><NavLink href="vehicledailyreport">@Lang["Menu1-3-2"]</NavLink></li>
                        <li><NavLink href="staffschart">@Lang["Menu1-3-3"]</NavLink></li>
                        <li><NavLink href="staffschedule">@Lang["Menu1-3-5"]</NavLink></li>
                        <li><NavLink href="leaveapplicationmanagement">@Lang["leavemanagement"]</NavLink></li>
                        <li><NavLink href="batchkobaninput">@Lang["batchkobaninput"]</NavLink></li>
                        <li>
                            <NavLink href="#menu8Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-3-4"]</NavLink>
                            <ul class="collapse list-unstyled" id="menu8Submenu" data-parent="#menu7Submenu">
                                <li><NavLink href="busreports">@Lang["Menu1-3-4-1"]</NavLink></li>
                                <li><NavLink href="attendanceconfirmreport">@Lang["Menu1-3-4-2"]</NavLink></li>
                                <li><NavLink href="operatinginstructionreport">@Lang["Menu1-3-4-3"]</NavLink></li>
                                <li><NavLink href="transportdailyreport">@Lang["Menu1-3-4-4"]</NavLink></li>
                                <li><NavLink href="repairlist">@Lang["Menu1-3-4-5"]</NavLink></li>
                                <li><NavLink href="attendancereport">@Lang["Menu1-3-4-6"]</NavLink></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu9Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-4"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu9Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="billschecklist">@Lang["Menu1-4-1"]</NavLink></li>
                        <li><NavLink href="invoiceissuerelease">@Lang["Menu1-4-2"]</NavLink></li>
                        <li><NavLink href="lockbooking">@Lang["Menu1-4-3"]</NavLink></li>
                        <li>
                            <NavLink href="#menu10Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-4-4"]</NavLink>
                            <ul class="collapse list-unstyled" id="menu10Submenu" data-parent="#menu9Submenu">
                                <li><NavLink href="billprint">@Lang["Menu1-4-4-1"]</NavLink></li>
                                <li><NavLink href="advancepaymentdetails">@Lang["Menu1-4-4-2"]</NavLink></li>
                                <li><NavLink href="billinglist">@Lang["Menu1-4-4-3"]</NavLink></li>
                                <li><NavLink href="receivablelist">@Lang["Menu1-4-4-4"]</NavLink></li>
                                <li><NavLink href="depositlist">@Lang["Menu1-4-4-5"]</NavLink></li>
                                <li><NavLink href="revenuesummary">@Lang["Menu1-4-4-6"]</NavLink></li>
                                <li><NavLink href="receiptoutput">@Lang["Menu1-4-4-7"]</NavLink></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu11Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-5"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu11Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="etcimport">@Lang["Menu1-5-1"]</NavLink></li>
                        <li><NavLink href="etc">@Lang["Menu1-5-2"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu12Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-6"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu12Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="transportationsummary">@Lang["Menu1-6-1"]</NavLink></li>
                        <li><NavLink href="monthlytransportationresult">@Lang["Menu1-6-2"]</NavLink></li>
                        <li>
                            <NavLink href="#menu13Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-6-3"]</NavLink>
                            <ul class="collapse list-unstyled" id="menu13Submenu" data-parent="#menu12Submenu">
                                <li><NavLink href="vehiclestatisticssurvey">@Lang["Menu1-6-3-1"]</NavLink></li>
                                <li><NavLink href="transportactualresult">@Lang["Menu1-6-3-2"]</NavLink></li>
                                <li><NavLink href="annualtransportationrecord">@Lang["Menu1-6-3-3"]</NavLink></li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu14Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu1-7"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu14Submenu" data-parent="#menu1Submenu">
                        <li><NavLink href="kashikirisetting">@Lang["Menu1-7-1"]</NavLink></li>
                        <li><NavLink>@Lang["Menu1-7-2"]</NavLink></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <NavLink href="#menu15Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-sticky-note mr-2"></i>@Lang["Menu2"]</NavLink>
            <ul class="collapse list-unstyled" id="menu15Submenu">
                <li>
                    <NavLink href="@(StickerServiceUrl + "/sticker")">@Lang["Menu2-1"]</NavLink>
                </li>
                <li>
                    <NavLink href="#menu16Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu2-2"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu16Submenu" data-parent="#menu15Submenu">
                        <li><NavLink href="@(StickerServiceUrl + "/stickersetting")">@Lang["Menu2-2-1"]</NavLink></li>
                        <li><NavLink href="@(StickerServiceUrl + "/customerstickermaster")">@Lang["Menu2-2-2"]</NavLink></li>
                        <li><NavLink href="@(StickerServiceUrl + "/stickersize")">@Lang["Menu2-2-3"]</NavLink></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <NavLink href="#menu17Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-database mr-2"></i>@Lang["Menu3"]</NavLink>
            <ul class="collapse list-unstyled" id="menu17Submenu">
                <li>
                    <NavLink href="#menu18Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-1"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu18Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/customer")" target="_blank">@Lang["Menu3-1-1"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu19Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-2"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu19Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/employeemaster")" target="_blank">@Lang["Menu3-2-1"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/jobtype")" target="_blank">@Lang["Menu3-2-2"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/holidayschedule")" target="_blank">@Lang["Menu3-2-3"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/checkinoutcalculationtime")" target="_blank">@Lang["Menu3-2-4"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu20Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-3"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu20Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/busmanagementmaster")" target="_blank">@Lang["Menu3-3-1"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/bustypemaster")" target="_blank">@Lang["Menu3-3-2"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/busrepairmaster")" target="_blank">@Lang["Menu3-3-3"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu21Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-4"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu21Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/company")" target="_blank">@Lang["Menu3-4-1"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/saleofficemaster")" target="_blank">@Lang["Menu3-4-2"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu22Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-5"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu22Submenu" data-parent="#menu17Submenu">
                        <li><NavLink>@Lang["Menu3-5-1"]</NavLink></li>
                        <li><NavLink>@Lang["Menu3-5-2"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/improvementcriteria")" target="_blank">@Lang["Menu3-5-3"]</NavLink></li>
                        <li><NavLink>@Lang["Menu3-5-4"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu23Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-6"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu23Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/reservationtypeorder")" target="_blank">@Lang["Menu3-6-1"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/futai")" target="_blank">@Lang["Menu3-6-2"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/passenger")" target="_blank">@Lang["Menu3-6-3"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu25Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu3-7"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu25Submenu" data-parent="#menu17Submenu">
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/placemaster")" target="_blank">@Lang["Menu3-7-1"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/placedispatchmaster")" target="_blank">@Lang["Menu3-7-2"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/transportationmethodsmaster")" target="_blank">@Lang["Menu3-7-3"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/connecteddelivery")" target="_blank">@Lang["Menu3-7-4"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/bank")" target="_blank">@Lang["Menu4-2-7"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/feestation")" target="_blank">@Lang["Menu3-7-5"]</NavLink></li>
                        <li><NavLink href="@(MasterMaintenanceServiceUrl + "/feestationdivision")" target="_blank">@Lang["Menu3-7-6"]</NavLink></li>
                    </ul>
                </li>
            </ul>
        </li>

        <li>
            <NavLink href="#menu29Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-files-o mr-2"></i>@Lang["Menu5"]</NavLink>
            <ul class="collapse list-unstyled" id="menu29Submenu">
                <li><NavLink href="/filemanager" target="_blank">@Lang["Menu5"]</NavLink></li>
            </ul>
        </li>

        <li>
            <NavLink href="#menu24Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle"><i class="fa fa-university mr-2"></i>@Lang["Menu4"]</NavLink>
            <ul class="collapse list-unstyled" id="menu24Submenu">
                <li>
                    <NavLink href="#menu26Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu4-1"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu26Submenu" data-parent="#menu24Submenu">
                        <li><NavLink href="@(AdministratorServiceUrl + "/tenantmaster")" target="_blank">@Lang["Menu4-1-1"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-1-2"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-1-3"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu27Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu4-2"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu27Submenu" data-parent="#menu24Submenu">
                        <li><NavLink>@Lang["Menu4-2-1"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-2-2"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-2-4"]</NavLink></li>
                        <li><NavLink href="@(AdministratorServiceUrl + "/payoff")" target="_blank">@Lang["Menu4-2-5"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-2-6"]</NavLink></li>
                        <li><NavLink href="@(AdministratorServiceUrl + "/tradermaster")" target="_blank">@Lang["Menu4-2-8"]</NavLink></li>
                    </ul>
                </li>
                <li>
                    <NavLink href="#menu28Submenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">@Lang["Menu4-3"]</NavLink>
                    <ul class="collapse list-unstyled" id="menu28Submenu" data-parent="#menu24Submenu">
                        <li><NavLink>@Lang["Menu4-3-1"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-3-2"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-3-3"]</NavLink></li>
                        <li><NavLink>@Lang["Menu4-3-4"]</NavLink></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</div>-->

@using SharedLibraries.UI.Services
@code {
    [Inject] private IKoboMenuService _menuService { get; set; }
    [Parameter] public bool IsMinimize { get; set; }

    protected string MasterMaintenanceServiceUrl { get; set; }
    protected string StickerServiceUrl { get; set; }
    protected string AdministratorServiceUrl { get; set; }
    protected List<KoboMenuItemModel> KoboMenuItems { get; set; } = new List<KoboMenuItemModel>();
    protected ClaimModel currentUser = new ClaimModel();
    Dictionary<int, string> serviceEndpoints = new Dictionary<int, string>();
    protected override async Task OnInitializedAsync()
    {
        if (HostEnvironment.IsProduction())
        {
            MasterMaintenanceServiceUrl = Configuration["ServiceUrls:MasterMaintenanceService"];
            StickerServiceUrl = Configuration["ServiceUrls:StickerService"] + "/stickerservice";
        }
        else
        {
            MasterMaintenanceServiceUrl = Configuration["ServiceUrls:MasterMaintenanceService"];
            StickerServiceUrl = Configuration["ServiceUrls:StickerService"];
        }
        AdministratorServiceUrl = Configuration["ServiceUrls:AdministratorService"];

        await InitMenu();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JSRuntime.InvokeVoidAsync("scroll");
        }
    }

    async Task InitMenu()
    {
        string culture = await _menuService.GetCurrentCultureAsync(currentUser.SyainCdSeq);
        serviceEndpoints.Add(2, MasterMaintenanceServiceUrl);
        serviceEndpoints.Add(3, StickerServiceUrl);
        serviceEndpoints.Add(4, AdministratorServiceUrl);
        KoboMenuItems = await _menuService.GetMenuItemsAsync(1, currentUser.SyainCdSeq, currentUser.TenantID, culture); // 1 is Kashikiri, 2 is Master, 3 is Sticker
    }

    //void OnClickToIndex()
    //{
    // var currentUri = NavManager.Uri;
    // var param = currentUri.Split('?').Count();
    // if (HostEnvironment.IsProduction())
    // {
    // if (param == 1)
    // {
    // NavManager.NavigateTo("/kashikiri/bookinginput");
    // }
    // else
    // {
    // NavManager.NavigateTo("/kashikiri/bookinginput", true);
    // }
    // }
    // else
    // {
    // if (param == 1)
    // {
    // NavManager.NavigateTo("/bookinginput");
    // }
    // else
    // {
    // NavManager.NavigateTo("/bookinginput", true);
    // }
    // }

    //}
}
